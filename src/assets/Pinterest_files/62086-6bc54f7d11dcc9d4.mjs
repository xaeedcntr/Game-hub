(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[62086],{170567:(e,t,a)=>{a.d(t,{UZ:()=>u,Z8:()=>l,my:()=>g});var r=a(667294),o=(a(702664),a(690108)),n=a(583592),d=a(785893);function s(e,t,a){var r;const o=[...null!==(r=t[e][a.payload.name])&&void 0!==r?r:[],a.payload.handler],n={...t};return n[e]={...t[e],[a.payload.name]:o},n}function i(e,t,a){if(!t[e][a.payload.name])return t;const r=t[e][a.payload.name].filter((e=>e!==a.payload.handler)),o={...t};return o[e]={...t[e],[a.payload.name]:r},o}const{Provider:c,useHook:m}=(0,n.Z)("ResourceContext");function u({children:e}){const[{listeners:t,moreListeners:a},n]=(0,r.useReducer)(((e,t)=>{switch(t.type){case"addListener":return s("listeners",e,t);case"addMoreListener":return s("moreListeners",e,t);case"removeListener":return i("listeners",e,t);case"removeMoreListener":return i("moreListeners",e,t);default:return e}}),{listeners:{},moreListeners:{}});o.Z.fetchCompleteCallback=({resource:e,options:a,response:r,normalizedResponse:o,refresh:n,resourceSchema:d})=>{t[e]&&t[e].forEach((t=>t({isRefresh:n,normalizedResponse:o,options:a,schema:d,resource:e,response:r})))},o.Z.fetchMoreCompleteCallback=({resource:e,options:t,response:r,normalizedResponse:o,refresh:n,resourceSchema:d})=>{a[e]&&a[e].forEach((a=>a({isRefresh:n,normalizedResponse:o,options:t,schema:d,resource:e,response:r})))};const m=(0,r.useMemo)((()=>({listenerDispatch:n})),[]);return(0,d.jsx)(c,{value:m,children:e})}function l(e,t){const{listenerDispatch:a}=m();(0,r.useEffect)((()=>(a({type:"addListener",payload:{name:e,handler:t}}),()=>{a({type:"removeListener",payload:{name:e,handler:t}})})))}function g(e,t){const{listenerDispatch:a}=m();(0,r.useEffect)((()=>(a({type:"addMoreListener",payload:{name:e,handler:t}}),()=>{a({type:"removeMoreListener",payload:{name:e,handler:t}})})))}},133244:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(667294);function o(e,t){const a=(0,r.useRef)([]),[o,n]=(0,r.useState)(),[d,s]=(0,r.useReducer)(null!=o?o:()=>t,t),i=(0,r.useCallback)((t=>{o?s(t):(a.current.length||e().then((e=>{n((()=>e.default))})),a.current=[...a.current,t])}),[e,o]);return(0,r.useEffect)((()=>{o&&(a.current.forEach(s),a.current=[])}),[o]),[d,i]}},76008:(e,t,a)=>{a.d(t,{pb:()=>R,nf:()=>A,lV:()=>G});var r=a(667294),o=a(702664),n=a(441143),d=a.n(n),s=a(690108),i=a(583592),c=a(970588),m=a(170567),u=a(618446),l=a.n(u),g=a(682492),p=a.n(g);const _={feature_map:Object.freeze({})},E=(e,t)=>{const a={...p()({},e,t),...t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({}),...t.tags?{tags:t.tags}:Object.freeze({}),...t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({})};return l()(e,a)?e:a},y=(e=_,t)=>{if("FETCH_COMPLETE"===t.type){const{payload:{resource:a}}=t,{data:r}=t.payload.response.resource_response;if("AggregatedCommentFeedResource"===a||"AggregatedCommentReplyFeedResource"===a||"DidItCommentsResource"===a){const t=(r||[]).reduce(((t,a)=>(t[a.id]=E(e[a.id],a),t)),{});return{...e,...t}}if("UnifiedCommentsResource"===a&&r&&r.length>0){const t=r.filter((e=>"aggregatedcomment"===e.type)).reduce(((t,a)=>(t[a.id]=E(e[a.id],a),t)),{});return{...e,...t}}if("UnifiedCommentsPreviewResource"===a&&r&&r.length>0){const t=r[0].aggregated_comment,a=t?{[t.id]:E(e[t.id],t)}:{},o=r[0].creator_reply,n=o?{[o.id]:E(e[o.id],o)}:{};return{...e,...a,...n}}if("AggregatedCommentFeaturesResource"===a&&r&&Object.keys(r).length>0)return{...e,feature_map:r}}else{if("AGGREGATED_COMMENT_CREATED"===t.type){const{payload:{aggregatedComment:a}}=t;return a.id?{...e,[a.id]:a}:e}if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){const{payload:{aggregatedCommentId:a}}=t,r={...e};return delete r[a],r}if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){const{payload:{userId:a}}=t;return Object.fromEntries(Object.entries(e).filter((e=>{var t;return(null===(t=e[1].user)||void 0===t?void 0:t.id)!==a})))}if("AGGREGATED_COMMENT_UPDATED"===t.type){const{payload:{data:a}}=t;return{...e,[a.id]:E(e[a.id],a)}}if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){const{payload:{data:a}}=t,r=e[a.id],o=r.reaction_counts[1]||0,n={1:a.reaction_by_me?o+1:o-1},d={...r,reaction_by_me:a.reaction_by_me,reaction_counts:n};return{...e,[a.id]:d}}if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){const{payload:{data:a}}=t,r=e[a.id],o=r.helpful_count||0,n=a.marked_helpful_by_me?o+1:o-1,d={...r,marked_helpful_by_me:a.marked_helpful_by_me,helpful_count:n};return{...e,[a.id]:d}}if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){const{payload:{data:a}}=t,r={...e[a.aggregated_comment_id],highlighted_by_pin_owner:a.is_highlighted};return{...e,[a.aggregated_comment_id]:r}}if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){const{payload:{data:{featureMap:a}}}=t;return{...e,feature_map:{...e.feature_map,...a}}}if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){const{payload:{increment:a,id:r}}=t,o=e[r];if(!o)return e;const n={...o,comment_count:o.comment_count+a};return{...e,[r]:n}}if("DELETE_COMMENT_MENTION"===t.type){const{payload:{aggregatedCommentId:a,tagged_users:r}}=t,o={...e[a],tagged_users:r};return{...e,[a]:o}}if("GET_COMMENT_TRANSLATION"===t.type){const{payload:{aggregatedCommentId:a,translatedText:r}}=t,o={...e[a],translatedText:r};return{...e,[a]:o}}}return e};var T=a(785893);const{Provider:C,useHook:f}=(0,i.Z)("AggregatedComments");function R({children:e}){const t=(0,o.useSelector)((({resources:e})=>e.UnifiedCommentsResource));let a=_;t&&Object.values(t).forEach((e=>{var t;const r=null===(t=e.data)||void 0===t?void 0:t.filter((e=>"aggregatedcomment"===e.type)),o=null==r?void 0:r.reduce(((e,t)=>(e[t.id]=E(a[t.id],t),e)),{});a={...a,...o}}));const[n,d]=(0,r.useReducer)(y,a),s=e=>{d({type:"FETCH_COMPLETE",payload:e})};(0,m.Z8)("AggregatedCommentFeaturesResource",s),(0,m.my)("AggregatedCommentFeaturesResource",s),(0,m.Z8)("AggregatedCommentFeedResource",s),(0,m.my)("AggregatedCommentFeedResource",s),(0,m.Z8)("AggregatedCommentReplyFeedResource",s),(0,m.my)("AggregatedCommentReplyFeedResource",s),(0,m.Z8)("DidItCommentsResource",s),(0,m.my)("DidItCommentsResource",s),(0,m.Z8)("UnifiedCommentsPreviewResource",s),(0,m.my)("UnifiedCommentsPreviewResource",s),(0,m.Z8)("UnifiedCommentsResource",s),(0,m.my)("UnifiedCommentsResource",s);const i=(0,r.useMemo)((()=>({aggregatedComments:n,dispatch:d})),[n,d]);return(0,T.jsx)(C,{value:i,children:e})}function A(){const{dispatch:e}=f();return(0,r.useMemo)((()=>({aggregatedCommentCreated(t,a){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:a}})},aggregatedCommentDeleted:(t,a)=>{e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:a}})},aggregatedCommentHidden:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:async({commentId:e,reason:t,detailedReasons:a})=>(0,c.Z)({url:`/v3/aggregated_comments/${e}/flag/`,method:"PUT",data:{commentId:e,reason:t,detailedReasons:a}}),deleteCommentMention:async t=>{var a;const{resource_response:r}=await(0,c.Z)({url:`/v3/aggregated_comments/${t}/mentions/`,method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}}),o=null!==(a=null==r?void 0:r.data)&&void 0!==a?a:{};e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:o.id,tagged_users:o.tagged_users}})},translateAggregatedComment:async t=>{try{var a;const{resource_response:r}=await(0,c.Z)({url:`/v3/aggregated_comments/${t}/translate/`,method:"GET"}),o=null!==(a=null==r?void 0:r.data)&&void 0!==a?a:"";e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:o}})}catch(r){e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:""}})}},toggleAggregatedCommentHelpful:({aggregatedCommentId:t,isMarkedHelpfulByMe:a})=>{(0,c.Z)({url:`/v3/helpful/1/${t}/`,method:a?"DELETE":"POST"}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:t,marked_helpful_by_me:!a}}})},toggleAggregatedCommentHighlight:async({aggregatedCommentId:t,pinId:a,isHighlighted:r})=>{d()(t),d()(a),await(0,c.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:t,pin:a,highlight:!r}}),e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:t,pin_id:a,is_highlighted:!r}}})},toggleAggregatedCommentLike:({aggregatedCommentId:t,isLikedByMe:a})=>{(0,c.Z)({url:`/v3/aggregated_comments/${t}/react/`,method:a?"DELETE":"POST",data:{reaction_type:1}}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:t,reaction_by_me:a?0:1}}})},updateAggregatedComment:async({commentId:t,force:a,orbacSubjectId:r,tags:o,text:n})=>{var d;const{resource_response:i}=await s.Z.create("AggregatedCommentResource",{commentId:t,force:a,tags:o,text:n,...r?{orbacSubjectId:r}:{}}).callUpdate({showError:!1}),{tagged_users:c}=null!==(d=null==i?void 0:i.data)&&void 0!==d?d:{},m=c.map((e=>({...e})));e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:t,tagged_users:m,tags:JSON.parse(o),text:n}}})},updateAggregatedCommentFeatures:async({userId:t,featureMap:a,passcode:r})=>{var o;const{resource_response:n}=await s.Z.create("AggregatedCommentFeaturesResource",{userId:t,featureMap:a,passcode:r}).callUpdate({showError:!1}),d=null!==(o=null==n?void 0:n.data)&&void 0!==o?o:Object.freeze({});e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:d}}})},updateCommentCount:(t,a)=>{e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:a,id:t}})}})),[e])}function G(){const{aggregatedComments:e}=f();return e}},94339:(e,t,a)=>{a.d(t,{G:()=>l,Kl:()=>g,vo:()=>u});var r=a(667294),o=a(583592),n=a(170567),d=a(133244),s=a(785893);const i=()=>a.e(90616).then(a.bind(a,390616)),{Provider:c,useHook:m}=(0,o.Z)("NativeEngagements");function u({children:e}){const[t,a]=(0,d.Z)(i,[]),o=e=>{a({type:"FETCH_COMPLETE",payload:e})};(0,n.Z8)("NativeInteractionsResource",o),(0,n.my)("NativeInteractionsResource",o);const m=(0,r.useMemo)((()=>({dispatch:a,nativeEngagements:t})),[a,t]);return(0,s.jsx)(c,{value:m,children:e})}function l(){const{dispatch:e}=m();return(0,r.useMemo)((()=>({nativeEngagementsHiddenForUser:t=>{e({type:"NATIVE_ENGAGEMENT_HIDDEN_FOR_USER",payload:{userId:t}})}})),[e])}function g(){const{nativeEngagements:e}=m();return e}},613352:(e,t,a)=>{a.d(t,{X:()=>m,f:()=>c});var r=a(667294),o=a(583592),n=a(898252);function d(e=null,t){switch(t.type){case"REPORT_CONTENT_SHOW":return{id:t.payload.id,isProduct:t.payload.isProduct,isPromoted:t.payload.isPromoted,parentId:t.payload.parentId,videoDuration:t.payload.videoDuration,viewParameter:t.payload.viewParameter,viewType:t.payload.viewType,type:t.payload.type};case"REPORT_CONTENT_DISMISS":return null;default:return e}}var s=a(785893);const{Provider:i,useHook:c}=(0,o.Z)("ReportData");function m({children:e}){const[t,a]=(0,r.useReducer)(d,null),o=(0,r.useCallback)((()=>a({type:"REPORT_CONTENT_DISMISS"})),[]),c=(0,r.useCallback)(((e,t,r)=>a({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,parentId:t,videoDuration:null,viewParameter:null,viewType:null,type:r}})),[]),m=(0,r.useCallback)(((e,t,r)=>a({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:r,type:"conversation"}})),[]),u=(0,r.useCallback)(((e,t,r)=>a({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:r,type:"pin"}})),[]),l=(0,r.useCallback)(((e,t,r)=>{const{id:o,is_downstream_promotion:d,promoter:s,rich_metadata:i,rich_summary:c,videos:m}=e,u=(0,n.VX)(i,c),l=(0,n.jL)(d,!!s);let g;const p=null==m?void 0:m.video_list;if(p){const e=p[Object.keys(p)[0]];g=null==e?void 0:e.duration}a({type:"REPORT_CONTENT_SHOW",payload:{id:o,isProduct:u,isPromoted:l,videoDuration:g,viewParameter:t,viewType:r,type:"pin"}})}),[]),g=(0,r.useMemo)((()=>({reportData:t,dismiss:o,reportComment:c,reportConversation:m,reportImage:u,reportPin:l})),[t,o,c,m,u,l]);return(0,s.jsx)(i,{value:g,children:e})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/62086-6bc54f7d11dcc9d4.mjs.map